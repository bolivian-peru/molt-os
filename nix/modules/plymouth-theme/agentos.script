# AgentOS Plymouth Theme — clean boot splash
# Dark background with centered wordmark and breathing animation

Window.SetBackgroundTopColor(0.04, 0.04, 0.06);
Window.SetBackgroundBottomColor(0.04, 0.04, 0.06);

# Load the logo image
logo.image = Image("logo.png");
logo.sprite = Sprite(logo.image);
logo.sprite.SetX(Window.GetWidth() / 2 - logo.image.GetWidth() / 2);
logo.sprite.SetY(Window.GetHeight() / 2 - logo.image.GetHeight() / 2);
logo.sprite.SetZ(10);
logo.opacity = 1.0;
logo.direction = -1;

# Breathing animation — subtle opacity pulse
fun refresh_callback() {
    logo.opacity += logo.direction * 0.008;
    if (logo.opacity <= 0.4) {
        logo.direction = 1;
        logo.opacity = 0.4;
    }
    if (logo.opacity >= 1.0) {
        logo.direction = -1;
        logo.opacity = 1.0;
    }
    logo.sprite.SetOpacity(logo.opacity);
}

Plymouth.SetRefreshFunction(refresh_callback);

# Suppress all text messages — clean boot
fun message_callback(text) {
}

Plymouth.SetMessageFunction(message_callback);

# Hide password prompt styling (still functional)
fun display_password_callback(prompt, bullets) {
    # Minimal password prompt for disk encryption
    passbox.image = Image.Text(prompt, 1.0, 1.0, 1.0);
    passbox.sprite = Sprite(passbox.image);
    passbox.sprite.SetX(Window.GetWidth() / 2 - passbox.image.GetWidth() / 2);
    passbox.sprite.SetY(Window.GetHeight() / 2 + logo.image.GetHeight() / 2 + 40);
    passbox.sprite.SetZ(20);

    bullet_string = "";
    for (i = 0; i < bullets; i++) {
        bullet_string += "●";
    }
    bulletbox.image = Image.Text(bullet_string, 0.6, 0.6, 0.7);
    bulletbox.sprite = Sprite(bulletbox.image);
    bulletbox.sprite.SetX(Window.GetWidth() / 2 - bulletbox.image.GetWidth() / 2);
    bulletbox.sprite.SetY(Window.GetHeight() / 2 + logo.image.GetHeight() / 2 + 70);
    bulletbox.sprite.SetZ(20);
}

Plymouth.SetDisplayPasswordFunction(display_password_callback);

# Progress bar (optional — hidden by default for clean look)
fun boot_progress_callback(duration, progress) {
    # Intentionally empty — we use the breathing animation instead
}

Plymouth.SetBootProgressFunction(boot_progress_callback);

fun quit_callback() {
    logo.sprite.SetOpacity(1.0);
}

Plymouth.SetQuitFunction(quit_callback);
